üß† –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä –õ—è–º–±–¥–∞-–ò—Å—á–∏—Å–ª–µ–Ω–∏—è

–ü—Ä–∏–≤–µ—Ç! –≠—Ç–æ –º–æ—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä–∞ –ª—è–º–±–¥–∞-–∏—Å—á–∏—Å–ª–µ–Ω–∏—è –Ω–∞ OCaml. –Ø —Å–¥–µ–ª–∞–ª —ç—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —á—Ç–æ–±—ã –≥–ª—É–±–∂–µ —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è –≤ –æ—Å–Ω–æ–≤–∞—Ö —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è –∏ —Ç–µ–æ—Ä–∏—Ç–∏—á–µ—Å–∫–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–µ.

–ß—Ç–æ —ç—Ç–æ —Ç–∞–∫–æ–µ?

–õ—è–º–±–¥–∞-–∏—Å—á–∏—Å–ª–µ–Ω–∏–µ ‚Äî —ç—Ç–æ —Ñ–æ—Ä–º–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞, –∫–æ—Ç–æ—Ä–∞—è –ª–µ–∂–∏—Ç –≤ –æ—Å–Ω–æ–≤–µ –º–Ω–æ–≥–∏—Ö —è–∑—ã–∫–æ–≤ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è. –ü–æ —Å—É—Ç–∏, —ç—Ç–æ –º–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π —è–∑—ã–∫ –≥–¥–µ –µ—Å—Ç—å —Ç–æ–ª—å–∫–æ —Ñ—É–Ω–∫—Ü–∏–∏ –∏ –∏—Ö –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ.

–í –º–æ–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –µ—Å—Ç—å:

–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ, –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–∏ (–ª—è–º–±–¥—ã) –∏ –∞–ø–ø–ª–∏–∫–∞—Ü–∏–∏
Œ≤-—Ä–µ–¥—É–∫—Ü–∏—è –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏–π
–†–∞—Å—à–∏—Ä—è–µ–º—ã–µ –ø—Ä–∏–º–∏—Ç–∏–≤—ã —á–µ—Ä–µ–∑ —Å–∏—Å—Ç–µ–º—É –∞—Ç–æ–º–æ–≤
–ü–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞ –∏–º—ë–Ω
–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?

–û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö

ocaml
type term = 
  | Var of string
  | Atom of string * int * (term list -> term)
  | App of term list
  | Lambda of string * term
Var "x" ‚Äî –æ–±—ã—á–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è
Lambda ("x", body) ‚Äî —Ñ—É–Ω–∫—Ü–∏—è Œªx.body
App [f; x; y] ‚Äî –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ f(x, y)
Atom ‚Äî —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–∏–º–∏—Ç–∏–≤—ã –≤—Ä–æ–¥–µ –∞—Ä–∏—Ñ–º–µ—Ç–∏–∫–∏
–°–µ—Ä–¥—Ü–µ —Å–∏—Å—Ç–µ–º—ã ‚Äî –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∞

ocaml
let rec substitute arg n body =
  match body with
  | Var m when m = n -> arg                    (* –ó–∞–º–µ–Ω—è–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é *)
  | Var m -> Var m                             (* –î—Ä—É–≥–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è ‚Äî –æ—Å—Ç–∞–≤–ª—è–µ–º *)
  | App terms -> App (List.map (substitute arg n) terms) (* –†–µ–∫—É—Ä—Å–∏—è –≤ –∞—Ä–≥—É–º–µ–Ω—Ç—ã *)
  | Lambda (bound_var, body_term) -> 
      if bound_var = n then Lambda (bound_var, body_term) (* –ù–µ –ª–µ–∑–µ–º –≤–Ω—É—Ç—Ä—å *)
      else Lambda (bound_var, substitute arg n body_term) (* –†–µ–∫—É—Ä—Å–∏—è –≤ —Ç–µ–ª–æ *)
  | Atom (name, arity, impl) -> body           (* –ê—Ç–æ–º—ã –Ω–µ —Ç—Ä–æ–≥–∞–µ–º *)
–≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –∞–∫–∫—É—Ä–∞—Ç–Ω–æ –∑–∞–º–µ–Ω—è–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ, —Å–ª–µ–¥—è —á—Ç–æ–±—ã –Ω–µ –±—ã–ª–æ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –∏–º—ë–Ω.

–í—ã—á–∏—Å–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ —Ä–µ–¥—É–∫—Ü–∏—é

ocaml
let rec reduce t =
  match t with
  | App ((Lambda (n, body)) :: arg :: tail) -> (* Œ≤-—Ä–µ–¥—É–∫—Ü–∏—è *)
      let reduced_arg = reduce arg in
      reduce (App (substitute reduced_arg n body :: tail))
  | App ((Atom (name, arity, impl)) :: tail) -> (* –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –ø—Ä–∏–º–∏—Ç–∏–≤–æ–≤ *)
      if List.length tail >= arity then
        reduce (impl tail)
      else
        App (Atom (name, arity, impl) :: List.map reduce tail)
  (* ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Å–ª—É—á–∞–∏ ... *)
–ü—Ä–∏–º–µ—Ä—ã –∏–∑ –∂–∏–∑–Ω–∏

–ë–∞–∑–æ–≤—ã–µ –∫–æ–º–±–∏–Ω–∞—Ç–æ—Ä—ã

ocaml
(* –¢–æ–∂–¥–µ—Å—Ç–≤–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è: Œªx.x *)
let id = Lambda ("x", Var "x")

(* K-–∫–æ–º–±–∏–Ω–∞—Ç–æ—Ä: Œªx.Œªy.x *)
let const = Lambda ("x", Lambda ("y", Var "x"))

(* S-–∫–æ–º–±–∏–Ω–∞—Ç–æ—Ä: Œªx.Œªy.Œªz.x z (y z) *)
let s = Atom ("S", 3, function  
  | x :: y :: z :: [] -> App [x; z; App [y; z]]
  | _ -> failwith "–ù—É–∂–Ω–æ 3 –∞—Ä–≥—É–º–µ–Ω—Ç–∞")


  –†–∞–∑–±–µ—Ä—ë–º —Å–ª–æ–∂–Ω—ã–π –ø—Ä–∏–º–µ—Ä

–î–∞–≤–∞–π—Ç–µ –ø–æ—Å–º–æ—Ç—Ä–∏–º –∫–∞–∫ –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –≤—ã—Ä–∞–∂–µ–Ω–∏–µ:

text
(Œªx.Œªy.((Œªx.Œªy.(x+y)) (x+5) (y+11))) 5 10
–í —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–µ –º–æ–µ–≥–æ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä–∞ —ç—Ç–æ –≤—ã–≥–ª—è–¥–∏—Ç —Ç–∞–∫:

ocaml
App [
  Lambda ("x", Lambda ("y", 
    App [
      App [
        Lambda ("x", Lambda ("y", App [plus; Var "x"; Var "y"])),
        App [plus; Var "x"; Atom "5"]
      ],
      App [plus; Var "y"; Atom "11"]
    ]
  )),
  Atom "5",
  Atom "10"
]
–®–∞–≥ –∑–∞ —à–∞–≥–æ–º:

–í–Ω–µ—à–Ω—è—è Œ≤-—Ä–µ–¥—É–∫—Ü–∏—è ‚Äî –ø—Ä–∏–º–µ–Ω—è–µ–º —Ñ—É–Ω–∫—Ü–∏—é –∫ 5
–ü–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∞ ‚Äî –∑–∞–º–µ–Ω—è–µ–º x –Ω–∞ 5 –≤–æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–º –≤—ã—Ä–∞–∂–µ–Ω–∏–∏
–í—ã—á–∏—Å–ª–µ–Ω–∏–µ 5+5 ‚Üí 10
–°–ª–µ–¥—É—é—â–∞—è Œ≤-—Ä–µ–¥—É–∫—Ü–∏—è ‚Äî –ø—Ä–∏–º–µ–Ω—è–µ–º –∫ 10
–ü–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∞ ‚Äî –∑–∞–º–µ–Ω—è–µ–º y –Ω–∞ 10
–í—ã—á–∏—Å–ª–µ–Ω–∏–µ 10+11 ‚Üí 21
–§–∏–Ω–∞–ª—å–Ω–æ–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ ‚Äî –ø–æ–ª—É—á–∞–µ–º 31
–í–µ—Å—å —ç—Ç–æ—Ç –ø—Ä–æ—Ü–µ—Å—Å —É–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è–º–∏ substitute –∏ reduce.

